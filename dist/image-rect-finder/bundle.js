(()=>{"use strict";function e(e,t,n){var i,o,r,a=t;return(i=[n],r=i.length,new Promise((function(e,t){function n(){--r||e(o)}o=i.map((function(e){var i=new Image;return i.onload=n,i.onerror=t,i.crossOrigin="",i.src=e,i}))}))).then((function(t){var n=t[0],i=document.createElement("canvas"),o=a.getBoundingClientRect();i.width=o.width,i.height=o.height;var r=i.getContext("2d"),d=n.naturalWidth/o.width,c=n.naturalHeight/o.height;return r.scale(o.width/n.naturalWidth,o.height/n.naturalHeight),r.drawImage(n,0,0),function(e,t,n,i,o){var r=t.getImageData(0,0,n,i),a=new Promise((function(t,n){e.onmessage=function(e){t(e.data)},e.onerror=n}));return e.postMessage({imageData:r,options:o},[r.data.buffer]),a}(e,r,o.width,o.height,{shade:0,candidateThreshold:20,topLeft:{targetBlockMax:10,edgeDiffMin:38},bottomRight:{targetBlockMax:12,edgeDiffMin:38}}).then((function(e){console.log("foundRect",e),r.clearRect(e.left*d,e.top*c,e.width*d,e.height*c),a.style.background="transparent",a.hasChildNodes()&&a.removeChild(a.firstChild),a.appendChild(i)}))}))}function t(t){var n,i=t.image,o=t.resizeWait,r=void 0===o?100:o,a=new Worker("find-rect-worker.js"),d=(n=i,window.getComputedStyle(n).getPropertyValue("background-image").match(/url\(["']*([^"')]+)["']*\)/)[1]),c=!1;return window.addEventListener("resize",(function(){c||(c=!0,setTimeout((function(){e(a,i,d).then((function(){c=!1})).catch((function(e){console.error("drawPhone failed",e),c=!1}))}),r))})),e(a,i,d)}window.addEventListener("DOMContentLoaded",(function(){t({image:document.querySelector(".image")})}),{once:!0})})();